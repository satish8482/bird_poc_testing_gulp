var pg=require("pg"),Sequelize=require("sequelize"),app=require("express")(),http=require("http").Server(app),env="development"==app.get("env")?"dev":app.get("env");pg.defaults.ssl=void 0!=process.env.DATABASE_URL;var port=process.env.PORT||8086,bodyParser=require("body-parser");app.use(bodyParser.urlencoded({extended:!1})),app.use(bodyParser.json());var router=(express=require("express")).Router(),sequelize=new Sequelize("d34eq7hbv7sgol","sqhjzsiqgxutpn","0ae8dd772f6a2be1e836e8dd9257cd7735a6b38a152e6abd83faf61457c250ea",{host:"ec2-107-22-235-167.compute-1.amazonaws.com",port:5432,dialect:"postgres",dialectOptions:{ssl:!0},DATABASE_URL:"postgres://sqhjzsiqgxutpn:0ae8dd772f6a2be1e836e8dd9257cd7735a6b38a152e6abd83faf61457c250ea@ec2-107-22-235-167.compute-1.amazonaws.com:5432/d34eq7hbv7sgol?ssl=true"});sequelize.authenticate().then(()=>{console.log("Connection has been established successfully.")}).catch(e=>{console.error("Unable to connect to the database:",e)});var Birds=sequelize.define("bird_table",{id:{type:Sequelize.STRING,primaryKey:!0},name:{type:Sequelize.STRING},family:{type:Sequelize.STRING},continents:{type:Sequelize.STRING},added:{type:Sequelize.STRING},visible:{type:Sequelize.STRING,defaultValue:!1},createdAt:{type:Sequelize.DATE},updatedAt:{type:Sequelize.DATE}});sequelize.sync({force:!0}).then(function(e){console.log("It worked!table created successfully")},function(e){console.log("An error occurred while creating the table:",e)}),sequelize.sync({force:!0}).then(function(){Birds.create({id:"1",name:"Peacock",family:"Family",continents:"india",added:"2017-10-04",visible:"true"}).then(function(){console.log("Data successfully inserted")})});var express=require("express"),bodyParser=require("body-parser");app.get("/Getbird",function(e,a){var t={Data:""};sequelize.query("SELECT * FROM bird_tables where visible=:visible",{replacements:{visible:"true"},type:sequelize.QueryTypes.SELECT}).then(function(e,s,r,i){e?(t.Data=e,a.json(t)):a.status(404).json(t)})}),app.post("/Postbird",function(e,a){var t=e.body.id,s=e.body.name,r=e.body.family,i=e.body.continents,d=e.body.added,o=e.body.visible;console.log(e.body),console.log(t);var n={Data:""};t&&s&&r&&i&&d&&o?sequelize.query("INSERT INTO bird_tables (id,name,family,continents,added,visible) VALUES('"+t+"','"+s+"','"+r+"','"+i+"','"+d+"','"+o+"')",[t,s,r,i,d,o],{type:sequelize.QueryTypes.INSERT}).then(function(e,t){n.Data=t?"Error Adding data":"Bird Added Successfully",a.json(n)}):(n.Data="Please provide all required data of bird",a.status(400).json(n))}),app.put("/Putbird",function(e,a){var t=e.body.id,s=e.body.name,r={Data:""};t&&s?sequelize.query("UPDATE bird_tables set name= '"+s+"' where id= '"+t+"' ",[t,s],{type:sequelize.QueryTypes.UPDATE}).then(function(e,t){r.Data=t?"Error Adding data":"Bird Updated Successfully",a.json(r)}):(r.Data="Please provide all required data of bird",a.status(404).json(r))}),app.delete("/Deletebird",function(e,a){var t=e.body.id,s={Data:""};t?sequelize.query("DELETE from  bird_tables where id= '"+t+"' ",[t],{type:sequelize.QueryTypes.DELETE}).then(function(e,t){s.Data=t?"Error Adding data":"Bird Deleted Successfully",a.json(s)}):(s.Data="Please provide all required data of bird",a.status(404).json(s))}),app.listen(port),console.log("Magic happens on port "+port);